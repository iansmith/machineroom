# app:
#   image: tutum/hello-world:latest
#   environment:
#     SERVICE_80_NAME: http
#     SERVICE_NAME: app
#     SERVICE_TAGS: production
#   ports:
#   - "80"

lb:
  build: ./lb
  links:
  - consul
  ports:
  - "80:80"

consul:
  command: -server -bootstrap -advertise 10.0.2.15
  image: progrium/consul:latest
  ports:
  - "8300:8300"
  - "8400:8400"
  - "8500:8500"
  - "8600:53/udp"

registrator:
  command: consul://consul:8500
  image: progrium/registrator:latest
  links:
  - consul
  volumes:
  - "/var/run/docker.sock:/tmp/docker.sock"

database:
  image: pg93:0.0.1
  ports:
  - "5432:5432"
  links:
  - consul
  environment:
    SERVICE_5432_NAME: postgres
    SERVICE_NAME: database
    SERVICE_TAGS: host_count

alpha:
  build: ./alpha
  ports:
  - "8888:80"
  environment:
    SERVICE_80_NAME: http
    SERVICE_NAME: alpha
    SERVICE_TAGS: development

beta:
  build: ./beta
  ports:
  - "8080:80"
  links:
  - consul
  volumes:
  - ./beta/static/:/static
  environment:
    SERVICE_80_NAME: http
    SERVICE_NAME: beta
    SERVICE_TAGS: development


